geocode_by_cell('1156 Susan Way Sunnyvale, CA 94087')
install.packages('ggmap', repos = 'https://cran.microsoft.com/snapshot/2019-02-01/')
geocode_by_cell('1156 Susan Way Sunnyvale, CA 94087')
packageVersion('ggmap')
#' Samantha Rhoads's function to...
#'
#' Srhoads wrote this to allow you to...
#' @export
#' @examples {geocode_by_cell('1156 Susan Way Sunnyvale, CA 94087')}
#' geocode_by_cell()
geocode_by_cell <- function(v, replacewith=NULL) lapply(v, function(s){
## ggmap VERSION NEEDED ():
# {install.packages('ggmap', repos = 'https://cran.microsoft.com/snapshot/2019-02-01/')}
if(is.null(replacewith)) replacewith <- s
# tryCatch(geocode(s, source="dsk") %>% unlist() %>% paste0(., collapse=", ") %>% clean_str_strip_NAs() %>% gsub(",", ", ", .) %>% trimws_(), error=function(e) s)
tryCatch(ggmap::geocode(s, source="dsk") %>% unlist() %>% paste0(., collapse=", ") %>% clean_unique_sep(., ", ") %>% na_if_(), error=function(e) {cat('\n#geocode_by_cell() ERROR:\n'); print(e); replacewith})
}) %>% unlist()
geocode_by_cell('1156 Susan Way Sunnyvale, CA 94087')
install.packages("https://cran.r-project.org/src/contrib/Archive/ggmap/ggmap_2.6.1.tar.gz", type="source", repos=NULL); .rs.restartR(); library(ggmap)
install.packages("https://cran.r-project.org/src/contrib/Archive/ggmap/ggmap_2.6.1.tar.gz", type="source", repos=NULL); .rs.restartR(); library(ggmap)
library(srhoads)
geocode_by_cell('1156 Susan Way Sunnyvale, CA 94087')
geocode_by_cell('Palo Alto')
geocode_by_cell('Santa Clara, CA')
geocode_by_cell('Stanford')
datatable
srhoads::getMostRecentFiles
#' Samantha Rhoads's function to take an Excel 5-digit date (or many digit datetime like '43467 381058125') + turn it into a date format
#' @export
#' @examples
#' excelToDateIf5DigitStrAndManyDigitTime(v)
excelToDateIf5DigitStrAndManyDigitTime <- function(v){ # ie: "43467 381058125"...or... "43467 402791006942"
if(
all(
unique(nchar(na.omit(
v %>% word(1) %>% gsub("[^[:digit:]]", "", .)
)))==5
) & all(
unique(nchar(na.omit(
v %>% word(2) %>% gsub("[[:digit:]]", "", .)
)))==0
)
){
v <- word(v, 1)
v <- lubridate::date(janitor::excel_numeric_to_date(as.numeric(v)))
} else {
if(any(grepl("\\.", v))&!is.Date.class(v)){
v <- gsub("\\.", " ", v)
v <- word(v, 1)
v <- tryCatch(lubridate::date(janitor::excel_numeric_to_date(as.numeric(v))), error=function(e) v)
}
}
v
}
excelToDateIf5DigitStrAndManyDigitTime('39328473')
excelToDateIf5DigitStrAndManyDigitTime('39328473333')
excelToDateIf5DigitStrAndManyDigitTime('39334')
excelToDateIf5DigitStrAndManyDigitTime('43467 381058125')
qdapRegex::rm_
zipcode5
zipcode5('329843902jdj239eu')
zipcode5('329843')
zipcode5('32984')
zipcode5('32984-eijf')
zipcode5('32984-1234')
zipcode5('32984-12345')
v <- c('924832sjkhf',' 20439-22912', '93488-9293', '23984_93284', '39842-3949 32432', '328rjd2 nh22 22242 ')
gsub('"(?<!\\d)\\d{5}(?!\\d)"', "", v)
gsub("(?<!\\d)\\d{5}(?!\\d)", "", v)
pattern="(?<!\\d)\\d{5}(?!\\d)"
gsub(pattern, "", v)
pattern="(?<!\\d)\\d{5}(?!\\d)"
stringr::str_extract_all(pattern, v)
pattern="(?<!\\d)\\d{5}(?!\\d)"
stringr::str_extract_all(pattern, v)
pattern="(?!\\d)\\d{5}(?!\\d)"
stringr::str_extract_all(pattern, v)
gsub("(?<!\\d)\\d{5}(?!\\d)", "", v)
gsub("(?!\\d)\\d{5}(?!\\d)", "", v)
gsub("(?\\d)\\d{5}(?!\\d)", "", v)
gsub("(\\d)\\d{5}(?!\\d)", "", v)
gsub("(\\d)\\d{5}(?\\d)", "", v)
gsub("(\\d)\\d{5}(\\d)", "", v)
gsub("(?<!\\d)\\d{5}(?\\d)", "", v)
gsub("(?<!\\d)\\d{5}(!\\d)", "", v)
gsub("(<!\\d)\\d{5}(?!\\d)", "", v)
gsub("(<\\d)\\d{5}(?!\\d)", "", v)
gsub("(\\d)\\d{5}(?!\\d)", "", v)
gsub("(\\d)\\d{5}(?\\d)", "", v)
gsub("(\\d)\\d{5}(!\\d)", "", v)
gsub("(<!\\d)\\d{5}(?!\\d)", "", v)
gsub("(<!\\d)\\d{5}(!\\d)", "", v)
gsub("(<!\\d)\\d{5}(!?\\d)", "", v)
gsub("(<?!\\d)\\d{5}(!?\\d)", "", v)
gsub("(?<!\\d)\\d{5}(!?\\d)", "", v)
gsub("?(<!\\d)\\d{5}(!?\\d)", "", v)
pattern="(<!\\d)\\d{5}(!\\d)"
stringr::str_extract_all(pattern, v)
pattern="\\d{5}(!\\d)"
stringr::str_extract_all(pattern, v)
pattern="\\d{5}(\\d)"
stringr::str_extract_all(pattern, v)
pattern="\\d{5}"
stringr::str_extract_all(pattern, v)
stringr::str_extract_all
stringr::str_extract_all(v, pattern)
pattern="(?<!\\d)\\d{5}(?!\\d)"
stringr::str_extract_all(v, pattern)
stringr::str_extract_all(v, pattern="(?<!\\d)\\d{5}(?!\\d)")
grDevices::axisTicks
.rs.restartR()
rm(list=ls())
roxygen2::roxygenise(clean=T)
devtools::document() # {roxygen2::roxygenise(clean=T)}
roxygen2::roxygenise(clean=T)
devtools::document() # {roxygen2::roxygenise(clean=T)}
system('git add -A && git commit -m "R/Python fxns cleanup"; git push') ### --- SHELL if you remove system()
devtools::install_github('srhoads/srhoads')
sprintf
dbDisconnect
DBI::dbDisconnec
DBI::dbDisconnect
roxygen2::roxygenise(clean=T)
devtools::document() # {roxygen2::roxygenise(clean=T)}
system('git add -A && git commit -m "R/Python fxns cleanup; rm_ds_store() fxn written"; git push') ### --- SHELL if you remove system()
devtools::install_github('srhoads/srhoads')
roxygen2::roxygenise(clean=T)
devtools::document() # {roxygen2::roxygenise(clean=T)}
system('git add -A && git commit -m "R/Python fxns cleanup; rm_ds_store() fxn written"; git push') ### --- SHELL if you remove system()
devtools::install_github('srhoads/srhoads')
#' Samantha Rhoads's function to tell the shell to open a file in whatever its default program is
#' @export
#' @examples
#' system_open(paths)
system_open <- open_system <- function(paths){
lapply(paths, function(s){
cmdstr <- paste0('open "', s, '"')
system(cmdstr)
})
return(paths)
}
bind_rows_
bind_rows
dplyr::bind_rows
x <- list(srhoads::dfsampler(), srhoads::dfsampler())
is.data.frame(x)
all(lapply(x, is.data.frame))
(lapply(x, is.data.frame)
)
(sapply(x, is.data.frame))
all(sapply(..., is.data.frame))
bind_rows_ <- function(..., .id = NULL){
if(is.data.frame(...)|all(sapply(..., is.data.frame))){
return(dplyr::bind_rows(..., .id = NULL))
} else {
return(...)
}
}
bind_rows_(x)
bind_rows_ <- function(..., .id = NULL){
if(is.data.frame(...)|all(sapply(..., is.data.frame))){
return(dplyr::bind_rows(..., .id = NULL))
} else {
return(...)
}
}
#' Samantha Rhoads's function to bind rows of object if they're dataframes
#' @export
#' @examples
#' bind_rows_(..., .id = NULL)
bind_rows_ <- function(..., .id = NULL){
if(is.data.frame(...)|all(sapply(..., is.data.frame))){
return(dplyr::bind_rows(..., .id = NULL))
} else {
return(...)
}
}
#' Samantha Rhoads's function to bind rows going multiple depths
#' @export
#' @examples
#' bind_rows2(l)
bind_rows2 <- function(l){
lapply(lapply2(l, bind_rows_), bind_rows_)
}
sep='///'
v <- 'hdkjsfhwjkfhd///sami///NA/sami/cats/NA'
paste0(sep, 'NA')
paste0(sep, 'NA($|', sep, ')')
paste0('(^|', sep, ')', 'NA($|', sep, ')')
# trimws_(gsub('///NA|NA///|^///|///$|^///|///$|^\\///|\\///$', '', v, perl=T)) %>% gsub(' ///|/// |//////', '///', ., perl=T) %>%
remove_str <- paste0('(^|', sep, ')', 'NA($|', sep, ')')
gsub(remove_str, sep, v, perl=T)
v <- 'hdkjsfhwjkfhd///sami///NA/sami/cats///NA'
v <- 'hdkjsfhwjkfhd///sami///NA///sami///cats///NA'
gsub(remove_str, sep, v, perl=T)
paste0('^', sep, '|', sep, '$')
paste0('^', sep, '|', sep, '$', '|', sep, sep)
# trimws_(gsub('///NA|NA///|^///|///$|^///|///$|^\\///|\\///$', '', v, perl=T)) %>% gsub(' ///|/// |//////', '///', ., perl=T) %>%
remove_str <- paste0('(^|', sep, ')', 'NA($|', sep, ')')
v_ <- gsub(remove_str, sep, v, perl=T)
trim_sep_str <- paste0('^', sep, '|', sep, '$', '|', sep, sep)
v_ <- gsub(trim_sep_str, '', v_, perl=T)
remove_duplicate_punct
#' Srhoads wrote this to allow you to...
#' @export
#' @examples
#' remove_duplicate_punct()
remove_duplicate_punct <- function(v, nrepeat=6){
sum <- 0
repeat{
sum <- sum + 1
v <- remove_duplicate_punct_separated_by_space_or_not(v)
if(sum==nrepeat) break
}
v
}
devtools::document() # {roxygen2::roxygenise(clean=T)}
roxygen2::roxygenise(clean=T)
system('git add -A && git commit -m "R/Python fxns cleanup; rm_ds_store() fxn written"; git push') ### --- SHELL if you remove system()
devtools::install_github('srhoads/srhoads')
1
#' This function allows you to trim whitespace but also remove double spaces
#' @export
#' @examples
#' trimws_(v, which='both', doublespace=T)
trimws_ <- function(v, which='both', doublespace=T){
if(which=="both"){v <- gsub("([[:space:]]| )$|^([[:space:]]| )", "", v)}
if(which=="left"){v <- gsub("^([[:space:]]| ){1,100}", "", v)}
if(which=="right"){v <- gsub("([[:space:]]| )${1,100}", "", v)}
if(doublespace) {v <- gsub('(   |  |[[:space:]][[:space:]]){1,100}', ' ', v)}
v <- trimws(v, which=which)
v
}
#' This function allows you to trim whitespace but also remove double spaces
#' @export
#' @examples
#' trimws_(v, which='both', doublespace=T)
trimws_ <- function(v, which='both', doublespace=T){
if(which=="both"){v <- gsub("([[:space:]]| )$|^([[:space:]]| )", "", v)}
if(which=="left"){v <- gsub("^([[:space:]]| ){1,100}", "", v)}
if(which=="right"){v <- gsub("([[:space:]]| )${1,100}", "", v)}
if(doublespace) {v <- gsub('(   |  |[[:space:]][[:space:]]){1,100}', ' ', v)}
v <- trimws(v, which=which)
v
}
r.R.home()
R.home()
roxygen2::roxygenise(clean=T)
devtools::document() # {roxygen2::roxygenise(clean=T)}
system('git add -A && git commit -m "added/edited functions"; git push') ### --- SHELL if you remove system()
devtools::install_github('srhoads/srhoads')
readxl::read_excel('/Users/rhoadss/Downloads/JGA_OLD.xlsx') %>% filter(OCCP %in% c('5710, 5720, 5730, 5740, 2100, 0020, 0150, 0110, 0360, 0136, 0120, 0010, 7905, 8990, 1551, 1555, 9620, 7340, 5940, 8800, 4220, 5240, 9645, 3300, 5120, 5600, 5150, 5360, 1050, 0705, 0750, 1610, 0700, 1430, 0650, 0800, 0520, 1021, 1022, 1400, 7000, 1006, 1720, 0845, 0960, 4850, 4930, 7700, 0735, 2840, 1460, 1410, 0140, 0137, 0160, 0300, 1105, 0565, 0051, 0052, 1935, 1970, 3330, 2631, 2632, 2633, 2634, 2635, 2636, 2640, 1005, 0060, 1106, 5400, 0725, 0135, 0101, 0102, 7720, 5100, 8140, 7750, 0820, 0830, 5850, 9130, 2145, 0630, 1065, 2861, 2865, 0640, 3421, 3422, 3423, 3424, 3430, 3545, 5140, 3050, 1007, 5630, 9050, 3255, 7140, 0810, 2825, 9030, 0220, 0410, 4965') %>% strsplit(., ', ') %>% unlist())
readxl::read_excel('/Users/rhoadss/Downloads/JGA_OLD.xlsx') %>% filter(occp %in% c('5710, 5720, 5730, 5740, 2100, 0020, 0150, 0110, 0360, 0136, 0120, 0010, 7905, 8990, 1551, 1555, 9620, 7340, 5940, 8800, 4220, 5240, 9645, 3300, 5120, 5600, 5150, 5360, 1050, 0705, 0750, 1610, 0700, 1430, 0650, 0800, 0520, 1021, 1022, 1400, 7000, 1006, 1720, 0845, 0960, 4850, 4930, 7700, 0735, 2840, 1460, 1410, 0140, 0137, 0160, 0300, 1105, 0565, 0051, 0052, 1935, 1970, 3330, 2631, 2632, 2633, 2634, 2635, 2636, 2640, 1005, 0060, 1106, 5400, 0725, 0135, 0101, 0102, 7720, 5100, 8140, 7750, 0820, 0830, 5850, 9130, 2145, 0630, 1065, 2861, 2865, 0640, 3421, 3422, 3423, 3424, 3430, 3545, 5140, 3050, 1007, 5630, 9050, 3255, 7140, 0810, 2825, 9030, 0220, 0410, 4965') %>% strsplit(., ', ') %>% unlist())
readxl::read_excel('/Users/rhoadss/Downloads/JGA_OLD.xlsx')
readxl::read_excel('/Users/rhoadss/Downloads/JGA_OLD.xlsx') %>% filter(OCCP %in% c('5710, 5720, 5730, 5740, 2100, 0020, 0150, 0110, 0360, 0136, 0120, 0010, 7905, 8990, 1551, 1555, 9620, 7340, 5940, 8800, 4220, 5240, 9645, 3300, 5120, 5600, 5150, 5360, 1050, 0705, 0750, 1610, 0700, 1430, 0650, 0800, 0520, 1021, 1022, 1400, 7000, 1006, 1720, 0845, 0960, 4850, 4930, 7700, 0735, 2840, 1460, 1410, 0140, 0137, 0160, 0300, 1105, 0565, 0051, 0052, 1935, 1970, 3330, 2631, 2632, 2633, 2634, 2635, 2636, 2640, 1005, 0060, 1106, 5400, 0725, 0135, 0101, 0102, 7720, 5100, 8140, 7750, 0820, 0830, 5850, 9130, 2145, 0630, 1065, 2861, 2865, 0640, 3421, 3422, 3423, 3424, 3430, 3545, 5140, 3050, 1007, 5630, 9050, 3255, 7140, 0810, 2825, 9030, 0220, 0410, 4965') %>% strsplit(., ', ') %>% unlist())
readxl::read_excel('/Users/rhoadss/Downloads/JGA_OLD.xlsx') %>% janitor::clean_names() %>% filter(occp %in% c('5710, 5720, 5730, 5740, 2100, 0020, 0150, 0110, 0360, 0136, 0120, 0010, 7905, 8990, 1551, 1555, 9620, 7340, 5940, 8800, 4220, 5240, 9645, 3300, 5120, 5600, 5150, 5360, 1050, 0705, 0750, 1610, 0700, 1430, 0650, 0800, 0520, 1021, 1022, 1400, 7000, 1006, 1720, 0845, 0960, 4850, 4930, 7700, 0735, 2840, 1460, 1410, 0140, 0137, 0160, 0300, 1105, 0565, 0051, 0052, 1935, 1970, 3330, 2631, 2632, 2633, 2634, 2635, 2636, 2640, 1005, 0060, 1106, 5400, 0725, 0135, 0101, 0102, 7720, 5100, 8140, 7750, 0820, 0830, 5850, 9130, 2145, 0630, 1065, 2861, 2865, 0640, 3421, 3422, 3423, 3424, 3430, 3545, 5140, 3050, 1007, 5630, 9050, 3255, 7140, 0810, 2825, 9030, 0220, 0410, 4965') %>% strsplit(., ', ') %>% unlist())
readxl::read_excel('/Users/rhoadss/Downloads/JGA_OLD.xlsx') %>% janitor::clean_names()->wtf
wtf$occp
library(tidyverse)
readxl::read_excel('/Users/rhoadss/Downloads/JGA_OLD.xlsx') %>% janitor::clean_names() %>% filter(occp %in% c('5710, 5720, 5730, 5740, 2100, 0020, 0150, 0110, 0360, 0136, 0120, 0010, 7905, 8990, 1551, 1555, 9620, 7340, 5940, 8800, 4220, 5240, 9645, 3300, 5120, 5600, 5150, 5360, 1050, 0705, 0750, 1610, 0700, 1430, 0650, 0800, 0520, 1021, 1022, 1400, 7000, 1006, 1720, 0845, 0960, 4850, 4930, 7700, 0735, 2840, 1460, 1410, 0140, 0137, 0160, 0300, 1105, 0565, 0051, 0052, 1935, 1970, 3330, 2631, 2632, 2633, 2634, 2635, 2636, 2640, 1005, 0060, 1106, 5400, 0725, 0135, 0101, 0102, 7720, 5100, 8140, 7750, 0820, 0830, 5850, 9130, 2145, 0630, 1065, 2861, 2865, 0640, 3421, 3422, 3423, 3424, 3430, 3545, 5140, 3050, 1007, 5630, 9050, 3255, 7140, 0810, 2825, 9030, 0220, 0410, 4965') %>% strsplit(., ', ') %>% unlist())
readxl::read_excel('/Users/rhoadss/Downloads/JGA_OLD.xlsx') %>% janitor::clean_names() %>% dplyr::filter(occp %in% c('5710, 5720, 5730, 5740, 2100, 0020, 0150, 0110, 0360, 0136, 0120, 0010, 7905, 8990, 1551, 1555, 9620, 7340, 5940, 8800, 4220, 5240, 9645, 3300, 5120, 5600, 5150, 5360, 1050, 0705, 0750, 1610, 0700, 1430, 0650, 0800, 0520, 1021, 1022, 1400, 7000, 1006, 1720, 0845, 0960, 4850, 4930, 7700, 0735, 2840, 1460, 1410, 0140, 0137, 0160, 0300, 1105, 0565, 0051, 0052, 1935, 1970, 3330, 2631, 2632, 2633, 2634, 2635, 2636, 2640, 1005, 0060, 1106, 5400, 0725, 0135, 0101, 0102, 7720, 5100, 8140, 7750, 0820, 0830, 5850, 9130, 2145, 0630, 1065, 2861, 2865, 0640, 3421, 3422, 3423, 3424, 3430, 3545, 5140, 3050, 1007, 5630, 9050, 3255, 7140, 0810, 2825, 9030, 0220, 0410, 4965') %>% strsplit(., ', ') %>% unlist())
readxl::read_excel('/Users/rhoadss/Downloads/JGA_OLD.xlsx') %>% dplyr::filter(OCCP %in% c('5710, 5720, 5730, 5740, 2100, 0020, 0150, 0110, 0360, 0136, 0120, 0010, 7905, 8990, 1551, 1555, 9620, 7340, 5940, 8800, 4220, 5240, 9645, 3300, 5120, 5600, 5150, 5360, 1050, 0705, 0750, 1610, 0700, 1430, 0650, 0800, 0520, 1021, 1022, 1400, 7000, 1006, 1720, 0845, 0960, 4850, 4930, 7700, 0735, 2840, 1460, 1410, 0140, 0137, 0160, 0300, 1105, 0565, 0051, 0052, 1935, 1970, 3330, 2631, 2632, 2633, 2634, 2635, 2636, 2640, 1005, 0060, 1106, 5400, 0725, 0135, 0101, 0102, 7720, 5100, 8140, 7750, 0820, 0830, 5850, 9130, 2145, 0630, 1065, 2861, 2865, 0640, 3421, 3422, 3423, 3424, 3430, 3545, 5140, 3050, 1007, 5630, 9050, 3255, 7140, 0810, 2825, 9030, 0220, 0410, 4965') %>% strsplit(., ', ') %>% unlist())
readxl::read_excel('/Users/rhoadss/Downloads/JGA_OLD.xlsx') %>% dplyr::filter(OCCP %in% c('5710, 5720, 5730, 5740, 2100, 0020, 0150, 0110, 0360, 0136, 0120, 0010, 7905, 8990, 1551, 1555, 9620, 7340, 5940, 8800, 4220, 5240, 9645, 3300, 5120, 5600, 5150, 5360, 1050, 0705, 0750, 1610, 0700, 1430, 0650, 0800, 0520, 1021, 1022, 1400, 7000, 1006, 1720, 0845, 0960, 4850, 4930, 7700, 0735, 2840, 1460, 1410, 0140, 0137, 0160, 0300, 1105, 0565, 0051, 0052, 1935, 1970, 3330, 2631, 2632, 2633, 2634, 2635, 2636, 2640, 1005, 0060, 1106, 5400, 0725, 0135, 0101, 0102, 7720, 5100, 8140, 7750, 0820, 0830, 5850, 9130, 2145, 0630, 1065, 2861, 2865, 0640, 3421, 3422, 3423, 3424, 3430, 3545, 5140, 3050, 1007, 5630, 9050, 3255, 7140, 0810, 2825, 9030, 0220, 0410, 4965'))
c('5710, 5720, 5730, 5740, 2100, 0020, 0150, 0110, 0360, 0136, 0120, 0010, 7905, 8990, 1551, 1555, 9620, 7340, 5940, 8800, 4220, 5240, 9645, 3300, 5120, 5600, 5150, 5360, 1050, 0705, 0750, 1610, 0700, 1430, 0650, 0800, 0520, 1021, 1022, 1400, 7000, 1006, 1720, 0845, 0960, 4850, 4930, 7700, 0735, 2840, 1460, 1410, 0140, 0137, 0160, 0300, 1105, 0565, 0051, 0052, 1935, 1970, 3330, 2631, 2632, 2633, 2634, 2635, 2636, 2640, 1005, 0060, 1106, 5400, 0725, 0135, 0101, 0102, 7720, 5100, 8140, 7750, 0820, 0830, 5850, 9130, 2145, 0630, 1065, 2861, 2865, 0640, 3421, 3422, 3423, 3424, 3430, 3545, 5140, 3050, 1007, 5630, 9050, 3255, 7140, 0810, 2825, 9030, 0220, 0410, 4965') %>% strsplit(., ', ') %>% unlist()
c('5710, 5720, 5730, 5740, 2100, 0020, 0150, 0110, 0360, 0136, 0120, 0010, 7905, 8990, 1551, 1555, 9620, 7340, 5940, 8800, 4220, 5240, 9645, 3300, 5120, 5600, 5150, 5360, 1050, 0705, 0750, 1610, 0700, 1430, 0650, 0800, 0520, 1021, 1022, 1400, 7000, 1006, 1720, 0845, 0960, 4850, 4930, 7700, 0735, 2840, 1460, 1410, 0140, 0137, 0160, 0300, 1105, 0565, 0051, 0052, 1935, 1970, 3330, 2631, 2632, 2633, 2634, 2635, 2636, 2640, 1005, 0060, 1106, 5400, 0725, 0135, 0101, 0102, 7720, 5100, 8140, 7750, 0820, 0830, 5850, 9130, 2145, 0630, 1065, 2861, 2865, 0640, 3421, 3422, 3423, 3424, 3430, 3545, 5140, 3050, 1007, 5630, 9050, 3255, 7140, 0810, 2825, 9030, 0220, 0410, 4965') %>% strsplit(., ', ') %>% unlist() %>% edit()
readxl::read_excel('/Users/rhoadss/Downloads/JGA_OLD.xlsx') %>% dplyr::filter(!OCCP %in% c("5710", "5720", "5730", "5740", "2100", "0020", "0150", "0110",
"0360", "0136", "0120", "0010", "7905", "8990", "1551", "1555",
"9620", "7340", "5940", "8800", "4220", "5240", "9645", "3300",
"5120", "5600", "5150", "5360", "1050", "0705", "0750", "1610",
"0700", "1430", "0650", "0800", "0520", "1021", "1022", "1400",
"7000", "1006", "1720", "0845", "0960", "4850", "4930", "7700",
"0735", "2840", "1460", "1410", "0140", "0137", "0160", "0300",
"1105", "0565", "0051", "0052", "1935", "1970", "3330", "2631",
"2632", "2633", "2634", "2635", "2636", "2640", "1005", "0060",
"1106", "5400", "0725", "0135", "0101", "0102", "7720", "5100",
"8140", "7750", "0820", "0830", "5850", "9130", "2145", "0630",
"1065", "2861", "2865", "0640", "3421", "3422", "3423", "3424",
"3430", "3545", "5140", "3050", "1007", "5630", "9050", "3255",
"7140", "0810", "2825", "9030", "0220", "0410", "4965")
)
readxl::read_excel('/Users/rhoadss/Downloads/JGA_OLD.xlsx') %>% dplyr::filter(!OCCP %in% c("5710", "5720", "5730", "5740", "2100", "0020", "0150", "0110",
"0360", "0136", "0120", "0010", "7905", "8990", "1551", "1555",
"9620", "7340", "5940", "8800", "4220", "5240", "9645", "3300",
"5120", "5600", "5150", "5360", "1050", "0705", "0750", "1610",
"0700", "1430", "0650", "0800", "0520", "1021", "1022", "1400",
"7000", "1006", "1720", "0845", "0960", "4850", "4930", "7700",
"0735", "2840", "1460", "1410", "0140", "0137", "0160", "0300",
"1105", "0565", "0051", "0052", "1935", "1970", "3330", "2631",
"2632", "2633", "2634", "2635", "2636", "2640", "1005", "0060",
"1106", "5400", "0725", "0135", "0101", "0102", "7720", "5100",
"8140", "7750", "0820", "0830", "5850", "9130", "2145", "0630",
"1065", "2861", "2865", "0640", "3421", "3422", "3423", "3424",
"3430", "3545", "5140", "3050", "1007", "5630", "9050", "3255",
"7140", "0810", "2825", "9030", "0220", "0410", "4965")
) %>% writexl_open()
readxl::read_excel('/Users/rhoadss/Downloads/JGA_OLD.xlsx') %>% dplyr::filter(OCCP %in% c("5710", "5720", "5730", "5740", "2100", "0020", "0150", "0110",
"0360", "0136", "0120", "0010", "7905", "8990", "1551", "1555",
"9620", "7340", "5940", "8800", "4220", "5240", "9645", "3300",
"5120", "5600", "5150", "5360", "1050", "0705", "0750", "1610",
"0700", "1430", "0650", "0800", "0520", "1021", "1022", "1400",
"7000", "1006", "1720", "0845", "0960", "4850", "4930", "7700",
"0735", "2840", "1460", "1410", "0140", "0137", "0160", "0300",
"1105", "0565", "0051", "0052", "1935", "1970", "3330", "2631",
"2632", "2633", "2634", "2635", "2636", "2640", "1005", "0060",
"1106", "5400", "0725", "0135", "0101", "0102", "7720", "5100",
"8140", "7750", "0820", "0830", "5850", "9130", "2145", "0630",
"1065", "2861", "2865", "0640", "3421", "3422", "3423", "3424",
"3430", "3545", "5140", "3050", "1007", "5630", "9050", "3255",
"7140", "0810", "2825", "9030", "0220", "0410", "4965")|grepl(',', OCCP)
) %>% writexl_open()
sort(c("5710", "5720", "5730", "5740", "2100", "0020", "0150", "0110",
+                                                                                            "0360", "0136", "0120", "0010", "7905", "8990", "1551", "1555",
+                                                                                            "9620", "7340", "5940", "8800", "4220", "5240", "9645", "3300",
+                                                                                            "5120", "5600", "5150", "5360", "1050", "0705", "0750", "1610",
+                                                                                            "0700", "1430", "0650", "0800", "0520", "1021", "1022", "1400",
+                                                                                            "7000", "1006", "1720", "0845", "0960", "4850", "4930", "7700",
+                                                                                            "0735", "2840", "1460", "1410", "0140", "0137", "0160", "0300",
+                                                                                            "1105", "0565", "0051", "0052", "1935", "1970", "3330", "2631",
+                                                                                            "2632", "2633", "2634", "2635", "2636", "2640", "1005", "0060",
+                                                                                            "1106", "5400", "0725", "0135", "0101", "0102", "7720", "5100",
+                                                                                            "8140", "7750", "0820", "0830", "5850", "9130", "2145", "0630",
+                                                                                            "1065", "2861", "2865", "0640", "3421", "3422", "3423", "3424",
+                                                                                            "3430", "3545", "5140", "3050", "1007", "5630", "9050", "3255",
+                                                                                            "7140", "0810", "2825", "9030", "0220", "0410", "4965"))
c('5710, 5720, 5730, 5740, 2100, 0020, 0150, 0110, 0360, 0136, 0120, 0010, 7905, 8990, 1551, 1555, 9620, 7340, 5940, 8800, 4220, 5240, 9645, 3300, 5120, 5600, 5150, 5360, 1050, 0705, 0750, 1610, 0700, 1430, 0650, 0800, 0520, 1021, 1022, 1400, 7000, 1006, 1720, 0845, 0960, 4850, 4930, 7700, 0735, 2840, 1460, 1410, 0140, 0137, 0160, 0300, 1105, 0565, 0051, 0052, 1935, 1970, 3330, 2631, 2632, 2633, 2634, 2635, 2636, 2640, 1005, 0060, 1106, 5400, 0725, 0135, 0101, 0102, 7720, 5100, 8140, 7750, 0820, 0830, 5850, 9130, 2145, 0630, 1065, 2861, 2865, 0640, 3421, 3422, 3423, 3424, 3430, 3545, 5140, 3050, 1007, 5630, 9050, 3255, 7140, 0810, 2825, 9030, 0220, 0410, 4965') %>% strsplit(., ', ') %>% unlist() %>% sort() %>% edit()
state_fips_df <- data.frame(stringsAsFactors = FALSE, state = c("AL","AK","AZ","AR","CA","CO","CT","DE","DC","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY","AS","GU","MP","PR","UM","VI"),
state_code = c("01","02","04","05","06","08","09","10","11","12","13","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","44","45","46","47","48","49","50","51","53","54","55","56","60","66","69","72","74","78"))
v <- 'United States Virgin Islands'
if(all(is.numeric(v))|all(lookslike_number(v))){
state_fips_df <- data.frame(stringsAsFactors = FALSE, state = c("AL","AK","AZ","AR","CA","CO","CT","DE","DC","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY","AS","GU","MP","PR","UM","VI"),
state_code = c("01","02","04","05","06","08","09","10","11","12","13","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","44","45","46","47","48","49","50","51","53","54","55","56","60","66","69","72","74","78"))
# state_fips_df$state[match(v, state_fips_df$state_code)] # as.numeric(state_fips_df$state)[match(v, as.numeric(state_fips_df$state_code))] # as.numeric(state_fips_df$state_code)[match(v, as.numeric(state_fips_df$state))]
v <- state_fips_df$state[match(readr::parse_number(as.character(v)), readr::parse_number(as.character(state_fips_df$state_code)))]
}
library(srhoads)
if(all(is.numeric(v))|all(lookslike_number(v))){
state_fips_df <- data.frame(stringsAsFactors = FALSE, state = c("AL","AK","AZ","AR","CA","CO","CT","DE","DC","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY","AS","GU","MP","PR","UM","VI"),
state_code = c("01","02","04","05","06","08","09","10","11","12","13","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","44","45","46","47","48","49","50","51","53","54","55","56","60","66","69","72","74","78"))
# state_fips_df$state[match(v, state_fips_df$state_code)] # as.numeric(state_fips_df$state)[match(v, as.numeric(state_fips_df$state_code))] # as.numeric(state_fips_df$state_code)[match(v, as.numeric(state_fips_df$state))]
v <- state_fips_df$state[match(readr::parse_number(as.character(v)), readr::parse_number(as.character(state_fips_df$state_code)))]
}
library(tidyverse)
if(all(is.numeric(v))|all(lookslike_number(v))){
state_fips_df <- data.frame(stringsAsFactors = FALSE, state = c("AL","AK","AZ","AR","CA","CO","CT","DE","DC","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY","AS","GU","MP","PR","UM","VI"),
state_code = c("01","02","04","05","06","08","09","10","11","12","13","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","44","45","46","47","48","49","50","51","53","54","55","56","60","66","69","72","74","78"))
# state_fips_df$state[match(v, state_fips_df$state_code)] # as.numeric(state_fips_df$state)[match(v, as.numeric(state_fips_df$state_code))] # as.numeric(state_fips_df$state_code)[match(v, as.numeric(state_fips_df$state))]
v <- state_fips_df$state[match(readr::parse_number(as.character(v)), readr::parse_number(as.character(state_fips_df$state_code)))]
}
state2abb_or_abb2state(v, abb=abb)
abb=T
from_fips=F
if(all(is.numeric(v))|all(lookslike_number(v))){
state_fips_df <- data.frame(stringsAsFactors = FALSE, state = c("AL","AK","AZ","AR","CA","CO","CT","DE","DC","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY","AS","GU","MP","PR","UM","VI"),
state_code = c("01","02","04","05","06","08","09","10","11","12","13","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","44","45","46","47","48","49","50","51","53","54","55","56","60","66","69","72","74","78"))
# state_fips_df$state[match(v, state_fips_df$state_code)] # as.numeric(state_fips_df$state)[match(v, as.numeric(state_fips_df$state_code))] # as.numeric(state_fips_df$state_code)[match(v, as.numeric(state_fips_df$state))]
v <- state_fips_df$state[match(readr::parse_number(as.character(v)), readr::parse_number(as.character(state_fips_df$state_code)))]
}
state2abb_or_abb2state(v, abb=abb)
st1 <- statetoabb(v) %>% abbtostate()
st2 <- abbtostate(v)
st1
st2
v <- c('United States Virgin Islands', 'Virgin Islands', 'Puerto Rico', 'guam', 'california', 'ca')
st1 <- statetoabb(v) %>% abbtostate()
st2 <- abbtostate(v)
st1
st2 <- abbtostate(v)
st2
if(!abb) ifelse(is.na(st1), st2, st1) else statetoabb(ifelse(is.na(st1), st2, st1))
v <- strip_punct(tolower(v), replacewithspace=F)
st <- c("Alabama", "Alaska", "Arizona", "Kansas", "Utah",
"Colorado", "Connecticut", "Delaware", "Florida", "Georgia",
"Hawaii", "Idaho", "Illinois", "Indiana", "Iowa", "Arkansas",
"Kentucky", "Louisiana", "Maine", "Maryland", "Massachusetts",
"Michigan", "Minnesota", "Mississippi", "Missouri", "Montana",
"Nebraska", "Nevada", "New Hampshire", "New Jersey",
"New Mexico", "New York", "North Carolina", "North Dakota",
"Ohio", "Oklahoma", "Oregon", "Pennsylvania", "Rhode Island",
"South Carolina", "South Dakota", "Tennessee", "Texas",
"California", "Vermont", "Virginia", "Washington", "West Virginia",
"Wisconsin", "Wyoming", "District of Columbia", "US Virgin Islands", "Puerto Rico") %>% tolower() %>% strip_punct(., replacewithspace=F)
ab <- c("AL", "AK", "AZ", "KS", "UT", "CO", "CT",
"DE", "FL", "GA", "HI", "ID", "IL", "IN", "IA", "AR",
"KY", "LA", "ME", "MD", "MA", "MI", "MN", "MS", "MO",
"MT", "NE", "NV", "NH", "NJ", "NM", "NY", "NC", "ND",
"OH", "OK", "OR", "PA", "RI", "SC", "SD", "TN", "TX",
"CA", "VT", "VA", "WA", "WV", "WI", "WY", "DC", "VI", "PR")
result <- ab[match(v, st)]
result
ifelse(is.na(result), v, result)
v
v <- c('United States Virgin Islands', 'Virgin Islands', 'Puerto Rico', 'guam', 'california', 'ca')
v <- c('United States Virgin Islands', 'Virgin Islands', 'Puerto Rico', 'guam', 'california', 'ca')
v_ <- strip_punct(tolower(v), replacewithspace=F)
st <- c("Alabama", "Alaska", "Arizona", "Kansas", "Utah",
"Colorado", "Connecticut", "Delaware", "Florida", "Georgia",
"Hawaii", "Idaho", "Illinois", "Indiana", "Iowa", "Arkansas",
"Kentucky", "Louisiana", "Maine", "Maryland", "Massachusetts",
"Michigan", "Minnesota", "Mississippi", "Missouri", "Montana",
"Nebraska", "Nevada", "New Hampshire", "New Jersey",
"New Mexico", "New York", "North Carolina", "North Dakota",
"Ohio", "Oklahoma", "Oregon", "Pennsylvania", "Rhode Island",
"South Carolina", "South Dakota", "Tennessee", "Texas",
"California", "Vermont", "Virginia", "Washington", "West Virginia",
"Wisconsin", "Wyoming", "District of Columbia", "US Virgin Islands", "Puerto Rico") %>% tolower() %>% strip_punct(., replacewithspace=F)
ab <- c("AL", "AK", "AZ", "KS", "UT", "CO", "CT",
"DE", "FL", "GA", "HI", "ID", "IL", "IN", "IA", "AR",
"KY", "LA", "ME", "MD", "MA", "MI", "MN", "MS", "MO",
"MT", "NE", "NV", "NH", "NJ", "NM", "NY", "NC", "ND",
"OH", "OK", "OR", "PA", "RI", "SC", "SD", "TN", "TX",
"CA", "VT", "VA", "WA", "WV", "WI", "WY", "DC", "VI", "PR")
result <- ab[match(v_, st)]
ifelse(is.na(result), v, result)
v_ <- strip_punct(tolower(v), replacewithspace=F)
st <- c("Alabama", "Alaska", "Arizona", "Kansas", "Utah",
"Colorado", "Connecticut", "Delaware", "Florida", "Georgia",
"Hawaii", "Idaho", "Illinois", "Indiana", "Iowa", "Arkansas",
"Kentucky", "Louisiana", "Maine", "Maryland", "Massachusetts",
"Michigan", "Minnesota", "Mississippi", "Missouri", "Montana",
"Nebraska", "Nevada", "New Hampshire", "New Jersey",
"New Mexico", "New York", "North Carolina", "North Dakota",
"Ohio", "Oklahoma", "Oregon", "Pennsylvania", "Rhode Island",
"South Carolina", "South Dakota", "Tennessee", "Texas",
"California", "Vermont", "Virginia", "Washington", "West Virginia",
"Wisconsin", "Wyoming", "District of Columbia", "US Virgin Islands", "Puerto Rico")
ab <- c("AL", "AK", "AZ", "KS", "UT", "CO", "CT",
"DE", "FL", "GA", "HI", "ID", "IL", "IN", "IA", "AR",
"KY", "LA", "ME", "MD", "MA", "MI", "MN", "MS", "MO",
"MT", "NE", "NV", "NH", "NJ", "NM", "NY", "NC", "ND",
"OH", "OK", "OR", "PA", "RI", "SC", "SD", "TN", "TX",
"CA", "VT", "VA", "WA", "WV", "WI", "WY", "DC", "VI", "PR") %>% tolower() %>% strip_punct(., replacewithspace=F)
result <- st[match(v_, ab)]
ifelse(is.na(result), v, result)
v_input=c('girl', 'dude')
match_vec=c('dude', 'man', 'girl', 'woman')
desired_vec=c('male', 'male', 'female', 'female')
desired_vec[match(v_input, match_vec)]
result <- desired_vec[match(v_input, match_vec)]
ifelse(is.na(result), v_input, result)
result <- desired_vec[match(v_input, match_vec)]
ifelse(is.na(result), v_input, result)
roxygen2::roxygenise(clean=T)
devtools::document() # {roxygen2::roxygenise(clean=T)}
system('git add -A && git commit -m "added/edited functions"; git push') ### --- SHELL if you remove system()
devtools::install_github('srhoads/srhoads')
rm(list=ls())
roxygen2::roxygenise(clean=T)
devtools::document() # {roxygen2::roxygenise(clean=T)}
system('git add -A && git commit -m "added/edited functions"; git push') ### --- SHELL if you remove system()
devtools::install_github('srhoads/srhoads')
result <- if(!abb) ifelse(is.na(st1), st2, st1) else statetoabb(ifelse(is.na(st1), st2, st1))
abb=F
st1 <- statetoabb(v) %>% abbtostate()
st2 <- abbtostate(v)
v <- c('United States Virgin Islands', 'VA', 'virginia')
st1 <- statetoabb(v) %>% abbtostate()
st2 <- abbtostate(v)
st1
st2
st2 <- abbtostate(v)
st2
result <- if(!abb) ifelse(is.na(st1), st2, st1) else statetoabb(ifelse(is.na(st1), st2, st1))
result
!(any(result) %in% c(state.abb, state.name))
any(result %in% c(state.abb, state.name))
any(tolower(v) %in% c(state.abb, state.name))
v_ <- tolower(v)
any(!tolower(v) %in% tolower(c(state.abb, state.name)))
!tolower(v) %in% tolower(c(state.abb, state.name))
v
any(!tolower(v) %in% tolower(c(state.abb, state.name)))
!tolower(v) %in% tolower(c(state.abb, state.name))
v_ <- tolower(v)
if(any(!tolower(v) %in% tolower(c(state.abb, state.name)))){
v_ <- gsub('united states', 'us', v_)
}
v_
st1 <- statetoabb(v) %>% abbtostate()
st2 <- abbtostate(v)
result <- if(!abb) ifelse(is.na(st1), st2, st1) else statetoabb(ifelse(is.na(st1), st2, st1))
result
v_ <- tolower(v)
if(any(!tolower(v) %in% tolower(c(state.abb, state.name)))){
v_ <- gsub('united states', 'us', v_)
}
st1 <- statetoabb(v_) %>% abbtostate()
st2 <- abbtostate(v_)
result <- if(!abb) ifelse(is.na(st1), st2, st1) else statetoabb(ifelse(is.na(st1), st2, st1))
result
abb=T
v_ <- tolower(v)
if(any(!tolower(v) %in% tolower(c(state.abb, state.name)))){
v_ <- gsub('united states', 'us', v_)
}
st1 <- statetoabb(v_) %>% abbtostate()
st2 <- abbtostate(v_)
result <- if(!abb) ifelse(is.na(st1), st2, st1) else statetoabb(ifelse(is.na(st1), st2, st1))
result
#' Srhoads wrote this to allow you to...
#' @export
#' @examples
#' state2abb_or_abb2state(v, abb=F)
state2abb_or_abb2state <- function(v, abb=F){
v_ <- tolower(v)
if(any(!tolower(v) %in% tolower(c(state.abb, state.name)))){
v_ <- gsub('united states', 'us', v_)
}
st1 <- statetoabb(v_) %>% abbtostate()
st2 <- abbtostate(v_)
result <- if(!abb) ifelse(is.na(st1), st2, st1) else statetoabb(ifelse(is.na(st1), st2, st1))
return(result)
}
